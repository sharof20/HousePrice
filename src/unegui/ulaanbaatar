from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
from selenium.common.exceptions import TimeoutException
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import pandas as pd
import time

# Initialize options for Chrome browser
chrome_options = Options()

# Create a new WebDriver instance with Chrome browser and set options
driver = webdriver.Chrome(chrome_options=chrome_options)


#This navigates the browser instance to the URL specified
driver.get("https://www.unegui.mn/l-hdlh/l-hdlh-zarna/oron-suuts-zarna/ulan-bator/")

# Find all elements on the page that match the specified XPath.
listing = driver.find_elements(By.XPATH,"//*[@id='listing']/section/div[2]/div[1]/div[2]/ul/li")

# Create an empty list to store the prices.
price_list = []

# Iterate over the elements found in the previous step.
for i in range(len(listing)):
    # Find the description and price of each element using XPATH.
    desc = listing[i].find_element(By.XPATH,"div[1]/div[2]/div/a").text
    price = listing[i].find_element(By.XPATH,"div[1]/div[3]/div").text
    room = listing[i].find_element(By.XPATH,"div[1]/div[2]/div/div[3]/span[2]").text
    # Print the description and price to the console.
    #print(desc,price)

    # Append the description and price to the price_list.
    price_list.append([desc,price,room])



# Create a pandas dataframe from the list of prices, with columns named "Тайлбар" and "Үнэ".
df = pd.DataFrame(price_list, columns = ["Тайлбар","Үнэ","Opoo"])

# Save the dataframe to a CSV file named "unegui.csv", with UTF-8 encoding.
df.to_csv("unegui.csv",encoding = "utf-8-sig")
